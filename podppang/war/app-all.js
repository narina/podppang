/*
Copyright(c) 2011 Company Name
*/
Ext.define("Heartyoh.mixin.Msg",function(){var b;function a(d,e){return'<div class="msg"><h3>'+d+"</h3><p>"+e+"</p></div>"}function c(e,f){if(!b){b=Ext.core.DomHelper.insertFirst(document.body,{id:"msg-div"},true)}var f=Ext.String.format.apply(String,Array.prototype.slice.call(arguments,1));var d=Ext.core.DomHelper.append(b,a(e,f),true);d.hide();d.slideIn("t").ghost("t",{delay:1000,remove:true})}return{msg:c}}());Ext.define("Heartyoh.mixin.User",function(){var b=login.username;function a(c){if(c!==undefined){b=c}return b}return{login:{id:a,name:a}}}());Ext.define("Heartyoh.mixin.Mixin",{mixin:function(b,a){try{switch(typeof(b)){case"string":Ext.apply(Ignite,Ext.create(b,a));return;case"object":Ext.apply(Ignite,b)}}catch(c){console.log(c.stack)}}});Ext.define("Heartyoh.mixin.UI",{addSystemMenu:function(a,b){try{var d=Ext.getCmp("system_menu");var g=Ext.create(a,b);d.insert(0,g);var c=6;d.items.each(function(e){c+=e.getWidth()});d.setSize(c,d.getHeight())}catch(f){}},addContentView:function(a){this.showBusy();var b;if(typeof(a)==="string"){b=Ext.create(a,{closable:true})}else{b=a}Ext.getCmp("content").add(b).show();this.clearStatus()},getMenu:function(a){return Ext.getCmp("content").getComponent(a)},doMenu:function(b){var a=Ext.getCmp("content");a.getLayout().setActiveItem(a.getComponent(b))}});Ext.define("Heartyoh.mixin.State",function(){return{show_running_vehicle:true,show_idle_vehicle:true,show_incident_vehicle:true}}());Ext.define("Heartyoh.mixin.SubItem",function(){Ext.Container.implement({sub:function(a){if(!this.subitems){this.subitems={}}if(!this.subitems[a]){this.subitems[a]=this.down("[itemId="+a+"]")}return this.subitems[a]}});return{}}());Ext.define("Heartyoh.mixin.Import",function(){function b(){var e=Ext.getCmp("content");var d=e.getLayout().getActiveItem();if(d.importUrl){Ext.create("Heartyoh.view.common.ImportPopup",{importUrl:d.importUrl,client:d,title:"Import"}).show()}}function c(){Ext.create("Heartyoh.view.common.ImportPopup",{importUrl:"incident/upload_log",title:"Upload Incident Log"}).show()}function a(){Ext.create("Heartyoh.view.common.ImportPopup",{importUrl:"incident/upload_video",title:"Upload Incident Video"}).show()}return{importData:b,uploadIncidentLog:c,uploadIncidentVideo:a}}());Ext.define("Heartyoh.view.Viewport",{extend:"Ext.container.Viewport",layout:"border",cls:"wrap",defaults:{split:false,collapsible:false},items:[{xtype:"viewport.north",region:"north",cls:"header",height:62},{xtype:"viewport.west",region:"west",cls:"tool",width:50},{xtype:"viewport.east",region:"east",cls:"summaryBoard",width:200},{xtype:"viewport.center",region:"center"}]});Ext.define("Heartyoh.model.Code",{extend:"Ext.data.Model",fields:[{name:"code",type:"string"},{name:"desc",type:"number"}]});Ext.define("Heartyoh.model.File",{extend:"Ext.data.Model",fields:[{name:"filename",type:"string"},{name:"creation",type:"number"},{name:"md5_hash",type:"string"},{name:"content_type",type:"string"},{name:"size",type:"string"}]});Ext.define("Heartyoh.view.viewport.Center",{extend:"Ext.panel.Panel",id:"content",alias:"widget.viewport.center",layout:"card",listeners:{add:function(a,c){if(a!==this){return}var b=Ext.getCmp("menutab");b.add({text:c.title,itemId:c.itemId,tooltip:c.title,handler:function(e){var f=Ext.getCmp("content");var d=f.getComponent(e.itemId);f.getLayout().setActiveItem(d)},closable:false}).setCard(c)},remove:function(a,c){if(a!==this){return}var b=Ext.getCmp("menutab");b.remove(c.itemId)}},defaults:{listeners:{activate:function(c){var b=Ext.getCmp("menutab");var a=b.getComponent(c.itemId);b.setActiveTab(a)}}},items:[]});Ext.define("Heartyoh.view.viewport.North",{extend:"Ext.Container",alias:"widget.viewport.north",layout:{type:"hbox",align:"stretch"},items:[{xtype:"brand",width:135},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"main_menu",flex:1},{xtype:"side_menu",width:180}]},{xtype:"tabbar",id:"menutab",height:23}]}]});Ext.define("Heartyoh.view.viewport.West",{extend:"Ext.panel.Panel",alias:"widget.viewport.west",cls:"tool",layout:{type:"vbox"},items:[{xtype:"button",cls:"btnAdd",html:"add"},{xtype:"button",cls:"btnRemove",html:"remove"},{xtype:"button",cls:"btnRefresh",html:"refresh"},{xtype:"button",cls:"btnImport",html:"import",handler:function(){Heartyoh.importData()}},{xtype:"button",cls:"btnEvent",html:"incident log",handler:function(){Heartyoh.uploadIncidentLog()}},{xtype:"button",cls:"btnEvent",html:"incident video",handler:function(){Heartyoh.uploadIncidentVideo()}},{xtype:"button",cls:"btnSave",html:"save"},{xtype:"button",cls:"btnExport",html:"export",}]});Ext.define("Heartyoh.view.viewport.East",{extend:"Ext.panel.Panel",alias:"widget.viewport.east",id:"east",cls:"summaryBoard",width:200,layout:{type:"vbox",align:"stretch"},initComponent:function(){this.callParent();var a=this;setInterval(function(){a.sub("time").update(Ext.Date.format(new Date(),"D Y-m-d H:i:s"))},1000);this.on("afterrender",function(){})},items:[{xtype:"searchfield",cls:"searchField",fieldLabel:"Search",labelWidth:50,labelSeparator:"",itemId:"search"},{xtype:"component",cls:"time",itemId:"time",html:Ext.Date.format(new Date(),"D Y-m-d H:i:s")}]});Ext.define("Heartyoh.view.Brand",{extend:"Ext.panel.Panel",alias:"widget.brand",html:"<a></a>"});Ext.define("Heartyoh.view.MainMenu",{extend:"Ext.toolbar.Toolbar",cls:"appMenu",alias:"widget.main_menu",defaults:{handler:function(c){var e=Ext.getCmp("content");var a=e.query("[closable=true]");for(var b=0;b<a.length;b++){e.remove(a[b])}var f=null;for(b=0;b<c.submenus.length;b++){c.submenus[b]["listeners"]={activate:function(i){var h=Ext.getCmp("menutab");var g=h.getComponent(i.itemId);h.setActiveTab(g)}};var d=e.add(c.submenus[b]);f=f||d}if(f){Heartyoh.doMenu(f.itemId)}}},items:[{text:"Dashboard",submenus:[{title:"File",xtype:"filemanager",itemId:"filemanager",closable:true}]},{text:"Company",submenus:[{title:T("company"),xtype:"management_company",itemId:"company",closable:true},{title:"Users",xtype:"management_user",itemId:"user",closable:true},{title:"Code Mgmt.",xtype:"management_code",itemId:"code",closable:true}]},{text:"Vehicle",submenus:[{title:T("vehicle"),xtype:"management_vehicle",itemId:"vehicle",closable:true}]}]});Ext.define("Heartyoh.view.SideMenu",{extend:"Ext.toolbar.Toolbar",alias:"widget.side_menu",cls:"sideMenu",items:[{type:"help",text:login.username,handler:function(){}},{itemId:"home",type:"home",cls:"btnHome",handler:function(){}},{itemId:"report",type:"report",cls:"btnReport",handler:function(){}},{itemId:"setting",type:"setting",cls:"btnSetting",handler:function(){}},{itemId:"logout",type:"logout",cls:"btnLogout",handler:function(){Ext.MessageBox.confirm("Confirm","Are you sure you want to do that?",function(a){if(a==="yes"){document.location.href="/logout.htm"}})}}]});Ext.define("Heartyoh.view.common.CodeCombo",{extend:"Ext.form.field.ComboBox",alias:"widget.codecombo",queryMode:"local",displayField:"code",matchFieldWidth:false,typeAhead:true,emptyText:"Alt+Q",group:"V-Maker",initComponent:function(){this.store=Ext.getStore("CodeStore").substore(this.group);this.emptyText=this.fieldLabel;this.callParent()},listConfig:{getInnerTpl:function(){return'<div class="codelist"><span class="code">{code}</span> ({desc})</div>'},minWidth:200}});Ext.define("Heartyoh.view.form.TimeZoneCombo",{extend:"Ext.form.field.ComboBox",alias:"widget.tzcombo",fieldLabel:"Choose TimeZone",store:"TimeZoneStore",queryMode:"local",displayField:"display",valueField:"value"});Ext.define("Heartyoh.view.form.SearchField",{extend:"Ext.form.field.ComboBox",alias:"widget.searchfield",queryMode:"local",displayField:"id",matchFieldWidth:false,typeAhead:true,emptyText:"Alt+Q",store:"VehicleStore",initComponent:function(){this.callParent();new Ext.util.KeyMap(document,{key:"q",alt:true,fn:this.focus,scope:this})},listConfig:{loadingText:"Searching...",emptyText:"No matching vehicles found.",getInnerTpl:function(){return'<div class="appSearchItem"><span class="id">{id}</span> <span class="registration_number">{registration_number}</span></div>'},minWidth:190},listeners:{select:function(d,b,c){var a=Ext.getStore("VehicleFilteredStore");a.clearFilter();a.filter([{property:"id",value:b[0].get("id")}])}}});Ext.define("Heartyoh.view.common.EntityFormButtons",{extend:"Ext.toolbar.Toolbar",alias:"widget.entity_form_buttons",dock:"bottom",layout:{align:"middle",type:"hbox"},items:[{xtype:"tbfill"},{text:"Save",itemId:"save"},{text:"Delete",itemId:"delete"},{text:"Reset",itemId:"reset"}],initComponent:function(){this.callParent();var a=this;this.down("#save").on("click",function(){var b=a.up("[entityUrl]");var c=b.entityUrl;var d=b.sub("form").getForm();if(d.isValid()){d.submit({url:c+"/save",success:function(f,g){var e=b.sub("grid").store;e.load(function(){f.loadRecord(e.findRecord("key",g.result.key))})},failure:function(e,f){Heartyoh.msg("Failed",f.result.msg)}})}});this.down("#delete").on("click",function(){var b=a.up("[entityUrl]");var c=b.entityUrl;var d=b.sub("form").getForm();if(d.isValid()){d.submit({url:c+"/delete",success:function(e,f){b.sub("grid").store.load();e.reset()},failure:function(e,f){Heartyoh.msg("Failed",f.result.msg)}})}});this.down("#reset").on("click",function(){var b=a.up("[entityUrl]");b.sub("form").getForm().reset()})}});Ext.define("Heartyoh.view.common.ProgressColumn",{extend:"Ext.grid.column.Column",alias:"widget.progresscolumn",cls:"x-progress-column",progressCls:"x-progress",progressText:"{0} %",constructor:function(c){var d=this,b=Ext.apply({},c),a=d.progressCls;d.callParent([b]);d.renderer=function(e,g){var h,f;f=Math.floor(e*d.getWidth(true));e=Ext.isFunction(b.renderer)?b.renderer.apply(this,arguments)||e:e;h=Ext.String.format(d.progressText,Math.round(e*100));g.tdCls+=" "+a+" "+a+"-"+d.ui;e='<div class="'+a+"-text "+a+'-text-back"><div>'+h+'</div></div><div class="'+a+'-bar" style="width: '+f+'px;"><div class="'+a+'-text"><div>'+h+"</div></div></div>";return e}},destroy:function(){delete this.renderer;return this.callParent(arguments)}});Ext.define("Heartyoh.view.file.FileManager",{extend:"Ext.panel.Panel",alias:"widget.filemanager",title:"FileManager",layout:{type:"vbox",align:"stretch",pack:"start"},initComponent:function(){this.callParent();this.add(Ext.create("Heartyoh.view.file.FileViewer",{flex:1}));this.add(Ext.create("Heartyoh.view.file.FileUploader",{flex:1}));this.add(Ext.create("Heartyoh.view.file.FileList",{flex:2}))}});Ext.define("Heartyoh.view.management.Company",{extend:"Ext.container.Container",alias:"widget.management_company",title:"Company",entityUrl:"company",layout:{align:"stretch",type:"vbox"},items:{html:'<div class="listTitle">Company List</div>'},initComponent:function(){var a=this;this.callParent(arguments);this.add(this.buildList(this));this.add(this.buildForm(this));this.sub("grid").on("itemclick",function(c,b){a.sub("form").loadRecord(b)});this.sub("grid").on("render",function(b){b.store.load()});this.sub("id_filter").on("change",function(c,b){a.search(a)});this.sub("name_filter").on("change",function(c,b){a.search(a)});this.down("#search_reset").on("click",function(){a.sub("id_filter").setValue("");a.sub("name_filter").setValue("")});this.down("#search").on("click",function(){a.sub("grid").store.load()})},search:function(a){a.sub("grid").store.clearFilter();a.sub("grid").store.filter([{property:"id",value:a.sub("id_filter").getValue()},{property:"name",value:a.sub("name_filter").getValue()}])},buildList:function(a){return{xtype:"gridpanel",itemId:"grid",store:"CompanyStore",flex:3,columns:[{dataIndex:"key",text:"Key",hidden:true},{dataIndex:"id",text:"ID"},{dataIndex:"name",text:"Name"},{dataIndex:"desc",text:"Description"},{dataIndex:"timezone",text:"TimeZone"},{dataIndex:"created_at",text:"Created At",xtype:"datecolumn",format:F("datetime"),width:120},{dataIndex:"updated_at",text:"Updated At",xtype:"datecolumn",format:F("datetime"),width:120}],viewConfig:{},onReset:function(b){b.down("textfield[name=id_filter]").setValue("");b.down("textfield[name=name_filter]").setValue("")},tbar:["ID",{xtype:"textfield",name:"id_filter",itemId:"id_filter",hideLabel:true,width:200},"NAME",{xtype:"textfield",name:"name_filter",itemId:"name_filter",hideLabel:true,width:200},{text:"Search",itemId:"search"},{text:"reset",itemId:"search_reset"}]}},buildForm:function(a){return{xtype:"form",itemId:"form",autoScroll:true,bodyPadding:10,cls:"hIndexbar",title:"Company Details",flex:2,defaults:{xtype:"textfield",anchor:"100%"},items:[{name:"key",fieldLabel:"Key",hidden:true},{name:"id",fieldLabel:"ID"},{name:"name",fieldLabel:"Name"},{name:"desc",fieldLabel:"Description"},{xtype:"tzcombo",name:"timezone",fieldLabel:"TimeZone"},{xtype:"datefield",name:"updated_at",disabled:true,fieldLabel:"Updated At",format:F("datetime")},{xtype:"datefield",name:"created_at",disabled:true,fieldLabel:"Created At",format:F("datetime")}],dockedItems:[{xtype:"entity_form_buttons"}]}}});Ext.define("Heartyoh.view.management.User",{extend:"Ext.container.Container",alias:"widget.management_user",title:"User",entityUrl:"user",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;this.items=[{html:'<div class="listTitle">User List</div>'},this.buildList(this),this.buildForm(this)],this.callParent(arguments);this.sub("grid").on("itemclick",function(c,b){a.sub("form").loadRecord(b)});this.sub("grid").on("render",function(b){b.store.load()});this.sub("email_filter").on("change",function(c,b){a.search(a)});this.sub("name_filter").on("change",function(c,b){a.search(a)});this.down("#search_reset").on("click",function(){a.sub("email_filter").setValue("");a.sub("name_filter").setValue("")});this.down("#search").on("click",function(){a.sub("grid").store.load()})},search:function(a){a.sub("grid").store.clearFilter();a.sub("grid").store.filter([{property:"email",value:a.sub("email_filter").getValue()},{property:"surname",value:a.sub("name_filter").getValue()}])},buildList:function(a){return{xtype:"gridpanel",itemId:"grid",store:"UserStore",flex:3,columns:[{dataIndex:"key",text:"Key",hidden:true},{dataIndex:"email",text:"email"},{dataIndex:"surname",text:"Sur Name"},{dataIndex:"nickname",text:"Nick Name"},{dataIndex:"forename",text:"For Name"},{dataIndex:"enabled",text:"Enabled"},{dataIndex:"admin",text:"Admin"},{dataIndex:"company",text:"Company"},{dataIndex:"created_at",text:"Created At",xtype:"datecolumn",format:F("datetime"),width:120},{dataIndex:"updated_at",text:"Updated At",xtype:"datecolumn",format:F("datetime"),width:120}],viewConfig:{},tbar:["e-mail",{xtype:"textfield",itemId:"email_filter",name:"email_filter",hideLabel:true,width:200},"NAME",{xtype:"textfield",itemId:"name_filter",name:"name_filter",hideLabel:true,width:200},{xtype:"button",itemId:"search",text:"Search",tooltip:"Find User"},{text:"reset",itemId:"search_reset"}]}},buildForm:function(a){return{xtype:"form",itemId:"form",bodyPadding:10,cls:"hIndexbar",title:"User Details",flex:2,autoScroll:true,items:[{xtype:"textfield",name:"key",fieldLabel:"Key",anchor:"100%",hidden:true},{xtype:"textfield",name:"email",fieldLabel:"e-mail",anchor:"100%"},{xtype:"textfield",name:"surname",fieldLabel:"Sur Name",anchor:"100%"},{xtype:"textfield",name:"nickname",fieldLabel:"Nick Name",anchor:"100%"},{xtype:"textfield",name:"forename",fieldLabel:"Fore Name",anchor:"100%"},{xtype:"checkbox",name:"enabled",fieldLabel:"Enabled",anchor:"100%"},{xtype:"checkbox",name:"admin",fieldLabel:"Admin",anchor:"100%"},{xtype:"textfield",name:"company",fieldLabel:"Company",disable:true,anchor:"100%"},{xtype:"datefield",name:"updated_at",disabled:true,fieldLabel:"Updated At",format:F("datetime"),anchor:"100%"},{xtype:"datefield",name:"created_at",disabled:true,fieldLabel:"Created At",format:F("datetime"),anchor:"100%"}],dockedItems:[{xtype:"entity_form_buttons",}]}}});Ext.define("Heartyoh.view.management.Code",{extend:"Ext.container.Container",alias:"widget.management_code",title:"Code Mgmt.",entityUrl:"code",importUrl:"code/import",afterImport:function(){this.sub("grid").store.load();this.sub("form").getForm().reset()},layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;this.items=[{html:'<div class="listTitle">Code List</div>'},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[this.zgrouplist,{xtype:"container",flex:1,cls:"borderRightGray",layout:{align:"stretch",type:"vbox"},items:[this.zcodelist,this.zform]}]}],this.callParent(arguments);this.sub("grid").on("itemclick",function(c,b){a.sub("form").loadRecord(b)});this.sub("grid").on("render",function(b){b.store.clearFilter(true);var c=a.sub("grouplist").store.first().get("group");b.store.filter("group",c);a.sub("form").getForm().setValues({group:c})});this.sub("grouplist").on("itemclick",function(c,b){a.sub("grid").store.clearFilter(true);a.sub("grid").store.filter("group",b.get("group"));a.sub("form").getForm().reset();a.sub("form").getForm().setValues({group:b.get("group")})})},zgrouplist:{xtype:"gridpanel",itemId:"grouplist",store:"CodeGroupStore",title:"Code Group",width:320,columns:[{dataIndex:"group",text:"Group",width:100},{dataIndex:"desc",text:"Description",width:220}]},zcodelist:{xtype:"gridpanel",itemId:"grid",store:"CodeStore",title:"Code List",flex:1,cls:"hIndexbarZero",columns:[{dataIndex:"key",text:"Key",hidden:true},{dataIndex:"group",text:"Group"},{dataIndex:"code",text:"Code"},{dataIndex:"desc",text:"Description"},{dataIndex:"created_at",text:"Created At",xtype:"datecolumn",format:F("datetime"),width:120},{dataIndex:"updated_at",text:"Updated At",xtype:"datecolumn",format:F("datetime"),width:120}]},zform:{xtype:"form",itemId:"form",bodyPadding:10,cls:"hIndexbar",title:"Code Details",height:200,defaults:{xtype:"textfield",anchor:"100%"},items:[{name:"key",fieldLabel:"Key",hidden:true},{xtype:"combo",name:"group",fieldLabel:"Group",queryMode:"local",store:"CodeGroupStore",displayField:"group",valueField:"group"},{name:"code",fieldLabel:"Code"},{name:"desc",fieldLabel:"Description"},{xtype:"datefield",name:"updated_at",disabled:true,fieldLabel:"Updated At",format:F("datetime")},{xtype:"datefield",name:"created_at",disabled:true,fieldLabel:"Created At",format:F("datetime")}],dockedItems:[{xtype:"entity_form_buttons"}]}});Ext.define("Heartyoh.view.management.Vehicle",{extend:"Ext.container.Container",alias:"widget.management_vehicle",title:"Vehicle",entityUrl:"vehicle",importUrl:"vehicle/import",afterImport:function(){this.sub("grid").store.load();this.sub("form").getForm().reset()},layout:{align:"stretch",type:"vbox"},items:{html:'<div class="listTitle">Vehicle List</div>'},initComponent:function(){var a=this;this.callParent(arguments);this.add(this.buildList(this));this.add(this.buildForm(this));this.sub("grid").on("itemclick",function(c,b){a.sub("form").loadRecord(b)});this.sub("grid").on("render",function(b){b.store.load()});this.sub("id_filter").on("change",function(c,b){a.search(a)});this.sub("registration_number_filter").on("change",function(c,b){a.search(a)});this.down("#search_reset").on("click",function(){a.sub("id_filter").setValue("");a.sub("registration_number_filter").setValue("")});this.down("#search").on("click",function(){a.sub("grid").store.load()});this.down("#image_clip").on("change",function(d,b){var c=a.sub("image");if(b!=null&&b.length>0){c.setSrc("download?blob-key="+b)}else{c.setSrc("resources/image/bgVehicle.png")}})},search:function(a){a.sub("grid").store.clearFilter();a.sub("grid").store.filter([{property:"id",value:a.sub("id_filter").getValue()},{property:"registration_number",value:a.sub("registration_number_filter").getValue()}])},buildList:function(a){return{xtype:"gridpanel",itemId:"grid",store:"VehicleStore",autoScroll:true,flex:1,columns:[{dataIndex:"key",text:"Key",type:"string",hidden:true},{dataIndex:"id",text:"Vehicle Id",type:"string"},{dataIndex:"registration_number",text:"RegistrationNumber",type:"string"},{dataIndex:"manufacturer",text:"Manufacturer",type:"string"},{dataIndex:"created_at",text:"Created At",xtype:"datecolumn",format:F("datetime"),width:120},{dataIndex:"updated_at",text:"Updated At",xtype:"datecolumn",format:F("datetime"),width:120}],viewConfig:{},tbar:["ID",{xtype:"textfield",name:"id_filter",itemId:"id_filter",hideLabel:true,width:200},"Registeration Number",{xtype:"textfield",name:"registration_number_filter",itemId:"registration_number_filter",hideLabel:true,width:200},{text:"Search",itemId:"search"},{text:"Reset",itemId:"search_reset"}]}},buildForm:function(a){return{xtype:"panel",bodyPadding:10,cls:"hIndexbar",title:"Vehicle Details",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"form",flex:1,autoScroll:true,defaults:{xtype:"textfield",anchor:"100%"},items:[{name:"key",fieldLabel:"Key",hidden:true},{name:"id",fieldLabel:"Vehicle Id"},{name:"registration_number",fieldLabel:"Registration Number"},{xtype:"codecombo",name:"manufacturer",group:"V-Maker",fieldLabel:"Manufacturer"},{xtype:"filefield",name:"image_file",fieldLabel:"Image Upload",msgTarget:"side",allowBlank:true,buttonText:"file..."},{name:"lattitude",fieldLabel:"Lattitude",disabled:true},{name:"longitude",fieldLabel:"Longitude",disabled:true},{xtype:"datefield",name:"updated_at",disabled:true,fieldLabel:"Updated At",format:F("datetime")},{xtype:"datefield",name:"created_at",disabled:true,fieldLabel:"Created At",format:F("datetime")},{xtype:"displayfield",name:"image_clip",itemId:"image_clip",hidden:true}]},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},cls:"noImage paddingLeft10",items:[{xtype:"image",height:"100%",itemId:"image"}]}],dockedItems:[{xtype:"entity_form_buttons"}]}}});Ext.define("Heartyoh.store.CompanyStore",{extend:"Ext.data.Store",autoLoad:true,fields:[{name:"key",type:"string"},{name:"id",type:"string"},{name:"name",type:"string"},{name:"desc",type:"string"},{name:"timezone",type:"int"},{name:"created_at",type:"date",dateFormat:"time"},{name:"updated_at",type:"date",dateFormat:"time"}],proxy:{type:"ajax",url:"company",reader:{type:"json"}}});Ext.define("Heartyoh.store.UserStore",{extend:"Ext.data.Store",fields:[{name:"key",type:"string"},{name:"email",type:"string"},{name:"company",type:"string"},{name:"forename",type:"string"},{name:"nickname",type:"string"},{name:"surname",type:"string"},{name:"admin",type:"boolean"},{name:"enabled",type:"boolean"},{name:"created_at",type:"date",dateFormat:"time"},{name:"updated_at",type:"date",dateFormat:"time"}],proxy:{type:"ajax",url:"user",reader:{type:"json"}}});Ext.define("Heartyoh.store.CodeGroupStore",{extend:"Ext.data.Store",autoLoad:true,fields:[{name:"group",type:"string"},{name:"desc",type:"string"}],data:[{group:"V-Type1",desc:"Type 1 of Vehicles"},{group:"V-Type2",desc:"Type 2 of Vehicles"},{group:"V-Type3",desc:"Type 3 of Vehicles"},{group:"V-Size",desc:"Size of Vehicles"},{group:"V-Maker",desc:"Vehicle Makers"},{group:"V-Model",desc:"Vehicle Model"},{group:"V-BirthYear",desc:"Vehicle Birth-Years"},{group:"V-Seat",desc:"Count of Seat of Vehicle"},{group:"V-Fuel",desc:"Types of Fuel of Vehicle"},{group:"ResvPurpose",desc:"Type of Reservation Purpose"},{group:"ResvStatus",desc:"Status of Reservation"},{group:"EmployeeTitle",desc:"Titles of Employee"},{group:"Division",desc:"Devisions of Company"},{group:"Consumable",desc:"Kinds of Consumables"}]});Ext.define("Heartyoh.store.CodeStore",{extend:"Ext.data.Store",autoLoad:true,fields:[{name:"key",type:"string"},{name:"group",type:"string"},{name:"code",type:"string"},{name:"desc",type:"string"},{name:"created_at",type:"date",dateFormat:"time"},{name:"updated_at",type:"date",dateFormat:"time"}],proxy:{type:"ajax",url:"code",reader:{type:"json"}},groupField:"group",groupDir:"DESC",substore:function(a){if(!this.substores){return null}return this.substores[a]},listeners:{load:function(b,a,c){if(!c){return}b.substores={};groups=b.getGroups();Ext.each(groups,function(d){b.substores[d.name]=Ext.create("Ext.data.Store",{model:"Heartyoh.model.Code",data:d.children})})}}});Ext.define("Heartyoh.store.VehicleStore",{extend:"Ext.data.Store",autoLoad:false,fields:[{name:"key",type:"string"},{name:"id",type:"string"},{name:"registration_number",type:"string"},{name:"manufacturer",type:"string"},{name:"vehicle_type",type:"string"},{name:"birth_year",type:"int"},{name:"ownership_type",type:"string"},{name:"status",type:"string"},{name:"image_clip",type:"string"},{name:"total_distance",type:"float"},{name:"remaining_fuel",type:"float"},{name:"distance_since_new_oil",type:"float"},{name:"engine_oil_status",type:"string"},{name:"fuel_filter_status",type:"string"},{name:"brake_oil_status",type:"string"},{name:"brake_pedal_status",type:"string"},{name:"cooling_water_status",type:"string"},{name:"timing_belt_status",type:"string"},{name:"spark_plug_status",type:"string"},{name:"driver_id",type:"string"},{name:"lattitude",type:"float"},{name:"driver_id",type:"string"},{name:"terminal_id",type:"string"},{name:"longitude",type:"float"},{name:"location",type:"string"},{name:"created_at",type:"date",dateFormat:"time"},{name:"updated_at",type:"date",dateFormat:"time"}],proxy:{type:"ajax",url:"vehicle",reader:{type:"json"}}});Ext.define("Heartyoh.store.TimeZoneStore",{extend:"Ext.data.Store",fields:["value","display"],data:[{value:-12,display:"(GMT -12:00) Eniwetok, Kwajalein"},{value:-11,display:"(GMT -11:00) Midway Island, Samoa"},{value:-10,display:"(GMT -10:00) Hawaii"},{value:-9,display:"(GMT -9:00) Alaska"},{value:-8,display:"(GMT -8:00) Pacific Time (US &amp; Canada)"},{value:-7,display:"(GMT -7:00) Mountain Time (US &amp; Canada)"},{value:-6,display:"(GMT -6:00) Central Time (US &amp; Canada), Mexico City"},{value:-5,display:"(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima"},{value:-4,display:"(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz"},{value:-3.5,display:"(GMT -3:30) Newfoundland"},{value:-3,display:"(GMT -3:00) Brazil, Buenos Aires, Georgetown"},{value:-2,display:"(GMT -2:00) Mid-Atlantic"},{value:-1,display:"(GMT -1:00 hour) Azores, Cape Verde Islands"},{value:0,display:"(GMT) Western Europe Time, London, Lisbon, Casablanca"},{value:1,display:"(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris"},{value:2,display:"(GMT +2:00) Kaliningrad, South Africa"},{value:3,display:"(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg"},{value:3.5,display:"(GMT +3:30) Tehran"},{value:4,display:"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi"},{value:4.5,display:"(GMT +4:30) Kabul"},{value:5,display:"(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent"},{value:5.5,display:"(GMT +5:30) Bombay, Calcutta, Madras, New Delhi"},{value:5.75,display:"(GMT +5:45) Kathmandu"},{value:6,display:"(GMT +6:00) Almaty, Dhaka, Colombo"},{value:7,display:"(GMT +7:00) Bangkok, Hanoi, Jakarta"},{value:8,display:"(GMT +8:00) Beijing, Perth, Singapore, Hong Kong"},{value:9,display:"(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk"},{value:9.5,display:"(GMT +9:30) Adelaide, Darwin"},{value:10,display:"(GMT +10:00) Eastern Australia, Guam, Vladivostok"},{value:11,display:"(GMT +11:00) Magadan, Solomon Islands, New Caledonia"},{value:12,display:"(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka"}]});Ext.define("Heartyoh.store.FileStore",{extend:"Ext.data.Store",storeId:"filestore",model:"Heartyoh.model.File",proxy:{type:"ajax",url:"/data/files.json",reader:{type:"json"}},autoLoad:true});Ext.define("Heartyoh.controller.ApplicationController",{extend:"Ext.app.Controller",stores:["CompanyStore","UserStore","CodeGroupStore","CodeStore","VehicleStore","TimeZoneStore","FileStore"],models:["Code","File"],views:["viewport.Center","viewport.North","viewport.West","viewport.East","Brand","MainMenu","SideMenu","common.CodeCombo","form.TimeZoneCombo","form.SearchField","common.EntityFormButtons","common.ProgressColumn","file.FileManager","management.Company","management.User","management.Code","management.Vehicle"],init:function(){this.control({viewport:{afterrender:this.onViewportRendered}})},onViewportRendered:function(){}});Ext.Loader.setConfig({enabled:true,paths:{Heartyoh:"app"}});Ext.define("Heartyoh",{singleton:true,mixins:{msg:"Heartyoh.mixin.Msg",user:"Heartyoh.mixin.User",mixin:"Heartyoh.mixin.Mixin",ui:"Heartyoh.mixin.UI",state:"Heartyoh.mixin.State",subitem:"Heartyoh.mixin.SubItem",util:"Heartyoh.mixin.Import"}});var console=console||{log:function(){},trace:function(){}};Ext.require("Heartyoh.view.Viewport");Ext.onReady(function(){Ext.application({name:"Heartyoh",autoCreateViewport:false,controllers:["Heartyoh.controller.ApplicationController"],launch:function(){Ext.create("Heartyoh.view.Viewport").show()}})});
